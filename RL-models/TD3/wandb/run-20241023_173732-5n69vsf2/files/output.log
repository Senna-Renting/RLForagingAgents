%%% unique-sweep-2 eblhatnh %%%
[ 0.85727507 -0.5148587   0.00817394]
Traceback (most recent call last):
  File "C:\Users\31614\Documents\AI_course_stuff\RLForaging Thesis\RLForagingAgents\RL-models\TD3\train_loops.py", line 142, in wandb_train_td3
    best_avg_return, best_policy = jax.lax.cond(avg_return > best_avg_return, new_policy, same_policy, best_avg_return, avg_return, best_policy, td3.get_policy())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\31614\anaconda3\Lib\site-packages\jax\_src\traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\31614\anaconda3\Lib\site-packages\jax\_src\lax\control_flow\conditionals.py", line 301, in cond
    return _cond(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\31614\anaconda3\Lib\site-packages\jax\_src\lax\control_flow\conditionals.py", line 248, in _cond
    _check_tree_and_avals("true_fun and false_fun output",
  File "C:\Users\31614\anaconda3\Lib\site-packages\jax\_src\lax\control_flow\common.py", line 214, in _check_tree_and_avals
    raise TypeError(f"{what} must have identical types, got\n{diff}.")
TypeError: true_fun and false_fun output must have identical types, got
('DIFFERENT ShapedArray(float32[]) vs. ShapedArray(int32[], weak_type=True)', State({
  'l1': {
    'bias': VariableState(
      type=Param,
      value='ShapedArray(float32[256])'
    ),
    'kernel': VariableState(
      type=Param,
      value='ShapedArray(float32[3,256])'
    )
  },
  'l2': {
    'bias': VariableState(
      type=Param,
      value='ShapedArray(float32[256])'
    ),
    'kernel': VariableState(
      type=Param,
      value='ShapedArray(float32[256,256])'
    )
  },
  'l3': {
    'bias': VariableState(
      type=Param,
      value='ShapedArray(float32[1])'
    ),
    'kernel': VariableState(
      type=Param,
      value='ShapedArray(float32[256,1])'
    )
  }
})).
