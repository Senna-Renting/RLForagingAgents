%%% eternal-sweep-1 v0jet9ma %%%
[ 0.85727507 -0.5148587   0.00817394]
Traceback (most recent call last):
  File "C:\Users\31614\Documents\AI_course_stuff\RLForaging Thesis\RLForagingAgents\RL-models\TD3\train_loops.py", line 142, in wandb_train_td3
    best_avg_return, best_policy = jax.lax.cond(avg_return > best_avg_return, new_policy, same_policy, best_avg_return, avg_return, best_policy, td3.get_policy())
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\31614\anaconda3\Lib\site-packages\jax\_src\traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\31614\anaconda3\Lib\site-packages\jax\_src\lax\control_flow\conditionals.py", line 301, in cond
    return _cond(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\31614\anaconda3\Lib\site-packages\jax\_src\lax\control_flow\conditionals.py", line 248, in _cond
    _check_tree_and_avals("true_fun and false_fun output",
  File "C:\Users\31614\anaconda3\Lib\site-packages\jax\_src\lax\control_flow\common.py", line 209, in _check_tree_and_avals
    raise TypeError(
TypeError: true_fun and false_fun output must have same type structure, got PyTreeDef((*, CustomNode(State[('l1', 'l2', 'l3')], [{'bias': CustomNode(VariableState[(<class 'flax.nnx.nnx.variables.Param'>, (('get_value_hooks', ()), ('set_value_hooks', ()), ('create_value_hooks', ()), ('add_axis_hooks', ()), ('remove_axis_hooks', ())))], [*]), 'kernel': CustomNode(VariableState[(<class 'flax.nnx.nnx.variables.Param'>, (('get_value_hooks', ()), ('set_value_hooks', ()), ('create_value_hooks', ()), ('add_axis_hooks', ()), ('remove_axis_hooks', ())))], [*])}, {'bias': CustomNode(VariableState[(<class 'flax.nnx.nnx.variables.Param'>, (('get_value_hooks', ()), ('set_value_hooks', ()), ('create_value_hooks', ()), ('add_axis_hooks', ()), ('remove_axis_hooks', ())))], [*]), 'kernel': CustomNode(VariableState[(<class 'flax.nnx.nnx.variables.Param'>, (('get_value_hooks', ()), ('set_value_hooks', ()), ('create_value_hooks', ()), ('add_axis_hooks', ()), ('remove_axis_hooks', ())))], [*])}, {'bias': CustomNode(VariableState[(<class 'flax.nnx.nnx.variables.Param'>, (('get_value_hooks', ()), ('set_value_hooks', ()), ('create_value_hooks', ()), ('add_axis_hooks', ()), ('remove_axis_hooks', ())))], [*]), 'kernel': CustomNode(VariableState[(<class 'flax.nnx.nnx.variables.Param'>, (('get_value_hooks', ()), ('set_value_hooks', ()), ('create_value_hooks', ()), ('add_axis_hooks', ()), ('remove_axis_hooks', ())))], [*])}]))) and PyTreeDef((*, None)).
